\documentclass{article}
\input{common}

\begin{document}

\section{Критические пары в~$\mathbb{Z}_p$}

\begin{definition}
	Если $A, B \subset \mathbb{Z}_p$ таковы, что $A + B \ne \mathbb{Z}_p$, $|A +
	B| = |A| + |B| - 1$, то такая пара множеств называется критической.
\end{definition}

\begin{theorem}[Воспер]
	Если $A, B$~--- критическая пара, то выполнено одно из следующих условий:
	\begin{itemize}
		\item $\min\{|A|, |B|\} = 1$
		\item $|A + B| = p - 1, 2 \le |A| \le p - 1, B = \overline{c - A}, \{c\} =
			\mathbb{Z}_p \setminus (A + B)$
		\item $A, B$~--- арифметические прогрессии с~одинаковой разностью
	\end{itemize}
\end{theorem}
\begin{proof}
	\begin{lemma}
		Если $(A, B)$~--- критическая и~$|A + B| = |A| + |B| - 1 < p - 1$, $A$~---
		арифметическая прогрессия, то $B$~--- прогрессия с~той же разностью.
	\end{lemma}
	\begin{lemma}
		Если $\min\{|A|,|B|\} = 2$, $(A, B)$~--- критическая, то $A, B$~---
		арифметические прогрессии с~одинаковой разностью.
	\end{lemma}
	\begin{lemma}
		Если $\min\{|A|,|B|\} \ge 2$, $(A, B)$~--- критическая, $|A + B| = |A| + |B|
		- 1 < p - 1$, тогда $(\overline{A+B}, -A)$~--- критическая.
	\end{lemma}

	Полагаем, что $\min\{|A|,|B|\} \ge 2$, $|A + B| = |A| + |B| - 1 < p - 1$.
	\begin{lemma}
		В~указанном предположении, если известно, что $A + B$~--- арифметическая
		прогрессия, то $A, B$~--- арифметические прогрессии с~одинаковой разностью.
	\end{lemma}
	\begin{proof}
		$A + B$~--- арифметическая прогрессия, значит $\overline{A + B}$ тоже
		прогрессия с~такой же разностью. Тогда по лемме $(\overline{A + B},
		-A)$~--- критическая и~так как $\overline{A + B}$~--- арифметическая
		прогрессия, то по другой лемме $-A$ и~$A$~--- прогрессии с~той же разностью
		(с~точностью до знака). Еще одно применение леммы даёт нам то, что $A$
		и~$B$~--- арифметические прогрессии с~одинаковой разностью.
	\end{proof}

	\begin{lemma}
		Если $(A, B)$~--- критическая, $0 \in B, |A| = k \ge 2, |B| = l \ge 3,
		|A + B| = |A| + |B| - 1 < p - 1$. Тогда найдётся $e \in A$, такое что
		$(A_{(e)}, B_{(e)})$~--- критическая пара, такая что $A_{(e)} + B_{(e)} = A
		+ B$ и~$2 \le |B_{(e)}| < |B|$.
	\end{lemma}
	\begin{proof}
		Возьмём произвольное $e \in A$. $A_{(e)} + B_{(e)} \subset A + B$. По
		тоереме Коши-Давенпорта $|A_{(e)}| + |B_{(e)}| - 1 \le |A_{(e)} + B_{(e)}|
		\le |A + B| = |A| + |B| - 1 = |A_{(e)}| + |B_{(e)}| - 1 \Rightarrow |A_{(e)}
		+ B_{(e)}| = |A + B| \Rightarrow A_{(e)} + B_{(e)} = A + B$.

		$X = \{e \in A: |B_{(e)}| < |B|\}$. Покажем, что $|X| \ge 2$. Если $e \in
		X$, то $B \cap (A - e) \subsetneq B$. Рассмотрим $Y = A \setminus X$. Для $e
		\in Y$ выполнено $B \subset A - e$. Пусть $Y \ne \varnothing$, иначе все
		тривиально. Пусть $Y \ne \varnothing$, тогда $\forall e \in A: B + e \subset
		A$. По теореме Коши-Давенпорта $|Y| + |B| - 1\le |Y + B| \le |A| = k$. $|Y|
		+ l - 1 = k - |X| + l - 1 \le k \Rightarrow |X| \ge l - 1 \ge 2$.

		Пусть $\forall e \in X, B_{(e)} = {0}$. $B' = B \setminus \{0\}$, тогда
		$\forall e \in X \rightarrow B' \cap (A - e) = \varnothing \Leftrightarrow
		\forall e \in X \rightarrow (B' + e) \cap A = \varnothing$. Тогда $(B' + X)
		\cap A = \varnothing \Rightarrow (X + B') \subset (A + B) \setminus A$.
		$|X| + l - 2 \le |X| + |B'| - 1 \le |A + B| - |A| = |B| - 1 = l - 1$. $|X| +
		l - 2 \le l - 1 \Rightarrow |X| \le 1$, противоречие.
	\end{proof}

	Индукция по~$|B|$. База $|B| = 2$ следует из леммы.

	Переход: $|B| = k + 1 \ge 3$. Сдвинем $B$ на элемент $b_0$ и~будем считать,
	что без ограничения общности $0 \in B$. По лемме, $\exists e \in A: (A_{(e)},
	B_{(e)})$~--- критическая, $A_{(e)} + B_{(e)} = A + B, 2 \le |B_{(e)}| < |B|$.
	По предположению индукции, $A_{(e)}, B_{(e)}$~--- арифметические прогессии
	с~одинаковой разностью, значит $A + B$~--- тоже. Тогда по доказанной лемме,
	$A, B$~--- арифметические прогрессие с~одинаковой разностью.
\end{proof}

\section{Неравенство Плюннеке-Руже}

\begin{theorem}[Неравенство треугольника Руже]
	Для любых конечных непустых $A, B, C \subset G$ выполнено $|A - B| \le
	\frac{|A - C||B - C|}{|C|}$.
\end{theorem}
\begin{proof}
	$A = \{a_0, \ldots, a_{k-1}\}, B = \{b_0, \ldots, b_{l-1}\}$. Пусть $e \in A -
	B$, определим $a_{(e)}$~--- наименьший по номеру элемент $A$, который может
	давать $e$. Рассмотрим $f: (e, c) \mapsto (a_{(e)} - c, c - b_{(e)})$. Если
	$f(e_1, c_1) = f(e_2, c_2)$, то $a_{(e_1)} - c_1 = a_{(e_2)} - c_2, c_1 -
	b_{(e_1)} = c_2 - b_{(e_2)}$, тогда $a_{(e_1)} - b_{(e_1)} = a_{(e_2)} -
	b_{(e_2)} \Rightarrow e_1 = e_2 \Rightarrow c_1 = c_2$. Стало быть, это
	инъекция. Значит $|A - B||C| \le |A - C||C - B|$.
\end{proof}

Как следствие $|A - A| \le \frac{|A + A|^2}{|A|}$.

\end{document}
