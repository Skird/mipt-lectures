\documentclass{article}
\input{common}

\begin{document}

\section{Определения, первые наблюдения}

Обозначения:
\begin{itemize}
	\item будем считать, что $A$~--- поднмножество (конечное, непустое) абелевой
		группы или коммутативного кольца~$R$.
	\item $A + B = \{a + b \mid a \in A, b \in B\}$, аналогично произведение.
\end{itemize}

Элементарные оценки:
\begin{itemize}
	\item $|A| \le |A + A| \le \frac{|A|(|A|+1)}{2}$.
	\item $\max\{|A|,|B|\} \le |A + B| \le |A||B|$.
	\item $|A| \le |A + \ldots + A| \le \overline{C}_{|A|}^k$.
\end{itemize}

\section{Простые структурные теоремы}

Пусть $|A + B| = |A|$ в~абелевой группе $G$. Если $0 \in B$, то $A \subset A + B
\Rightarrow A + B = A$. Иначе возьмём $b_0 \in B$ и~рассмотрим $|A + (B - b_0)|
= |A + B| = |A| \Rightarrow A + B = b_0 + A$.

Определим $H = Sym(A) = \{h \in G \mid h + A = A\}$. Это, очевидно, подгруппа,
называется она группой симметрии~$A$. Пусть теперь $(g + H) \cap A \ne
\varnothing$ для $g \in G$. Тогда $a \in A \cap (g + H) \Rightarrow a = g + h,
h \in H$. По определению $a + H \subset A$, но тогда $g + h + H = g + H$.

\begin{theorem}
	Если $|A + B| = |A|$,  $H = \{h \in G \mid h + A = A\}$, то $B$ является
	подмножеством смежного класса по $H$, а~$A$~--- объединением смежных классов
	по~$H$.
\end{theorem}

В~частности для $\mathbb{R}$ получаем, что $|A + B| = |A| \Rightarrow |B| = 1$.

Для $\mathbb{Z}_p$ точно также получаем, что либо $H = 0$, либо $H =
\mathbb{Z}_p$, отсюда $|A + B| = |A| \Rightarrow A = \mathbb{Z}_p$ или $|B| =
1$.

\begin{claim}
	Для любых подмножеств $A, B \subset \mathbb{R}$ выполнено $|A + B| \le |A| +
	|B| - 1$.
\end{claim}
\begin{proof}
	Запишем $A = \{a_0 < \ldots < a_{k-1}\}, B = \{b_0 < \ldots < b_{l-1}\}$.
	Тогда легко предъявить цепочку элементов $A + B$: $a_0 + b_0 < a_0 + b_1 <
	a_0 + b_2 < \ldots < a_0 + b_{l-1} < a_1 + b_{l-1} < \ldots < a_{k-1} +
	b_{l-1}$. В~ней $k + l - 1$ элемент.
\end{proof}

\begin{theorem}
	$|A + A| = 2|A| - 1 \Leftrightarrow A$~--- арифметическая прогрессия.
\end{theorem}
\begin{proof}
	$A = \{ a_0 < \ldots < a_{k-1} \}$. Предъявим цепочку $2a_0 < a_0 + a_1 < 2a_1
	< a_1 + a_2 < \ldots < 2a_{k-2} < a_{k-2} + a_{k-1} < 2a_{k-1}$, ясно, что
	других элементов быть не может.

	С~другой стороны $a_{i-1} + a_i < a_{i+1} + a_{i-1} < a_i + a_{i+1}$, значит
	$a_{i+1} + a_{i-1} = 2a_i$, значит в~самом деле это прогрессия.
\end{proof}

\begin{theorem}
	Пусть $A, B \subset \mathbb{R}, |A| = |B|$, тогда $|A + B| = |A| + |B| -
	1 \Leftrightarrow A, B$~--- арифметические прогрессии с~одинаковой разностью.
\end{theorem}
\begin{proof}
	Пусть для начала $|A| = |B| = k$. Предъявим цепочку $a_0 + b_0 < a_0 + b_1 <
	a_1 + b_1 < \ldots < a_{k-1} + b_{k-1}$, других элементов быть не может.

	С~другой стороны $a_i + b_i < a_{i+1} + b_i < a_{i+1} + b_{i+1}$, значит
	$a_{i+1} + b_i = a_i + b_{i+1} \Rightarrow a_{i+1} - a_i = b_{i+1} - b_i$.

	Также $a_{i-1} + b_{i} < a_{i-1} + b_{i+1} < a_{i} + b_{i+1}$, значит $a_{i-1}
	+ b_{i+1} = a_{i} + b_{i} \Rightarrow a_i - a_{i-1} = b_{i+1} - b_{i}$, что
	доказывает теорему в~этом частном случае.

	Пусть теперь $|A| = k \le l = |B|$. Пусть $1 \le t \le l - k$~--- произвольный
	параметр. Разобьём $B = B_1 \sqcup B_2 \sqcup B_3$ на три части $B_1 = \{b_0 <
	\ldots < b_{t-1}\}, B_2 = \{b_t < \ldots < b_{k+t-1}\}, B_3 = \{b_{k+t} <
	\ldots < b_{l-1}\}$.

	$A + B \subset (a_0 + B_1) \sqcup (A + B_2) \sqcup (a_{k-1} + B_3)$. С~другой
	стороны $|a_0 + B_1| = t, |A + B_2| \ge 2k - 1, |a_{k-1} + B_3| = l - k - t$,
	поэтому $|A + B_2| = 2k - 1, |A| = |B_2| = k \Rightarrow A, B_2$~--- это
	арифметические прогрессии с~равным шагом. В~силу произвольности параметра,
	получаем утверждение теоремы.
\end{proof}

\section{e-преобразование и~теорема Коши-Давенпорта}

Пусть $A, B \subset G, e \in G$, тогда определим преобразование пары множеств
$A_{(e)} = A \cup (B + e), B_{(e)} = B \cap (A - e)$.

Чтобы $B$ было непустым, нужно $b \in B \Rightarrow b = a - e, a \in A
\Rightarrow e = a - b \in A - B$.

Свойства:
\begin{itemize}
	\item Пусть $a \in A_{(e)} \Rightarrow a \in A$ или $a \in B + e$. Тогда
		$a + B_{(e)} \subset A + B$ в~том и~другом случае.
	\item По формуле включения исключения
		$|A_{(e)}| = |A| + |B| - |A \cap (B + e)| = |A| + |B| - |B_{(e)} + e|
		\Rightarrow |A_{(e)}| + |B_{(e)}| = |A| + |B|$.
	\item $B_{(e)} \subset B, A \subset A_{(e)}$.
\end{itemize}

\begin{theorem}[Коши-Давенпорта]
	Пусть~$A, B \subset \mathbb{Z}_p$, тогда $|A + B| \ge \min\{|A| + |B| - 1,
	p\}$.
\end{theorem}
\begin{proof}
	Проведём индукцию по мощности $|B|$. База $|B| = 1$ очевидна. Докажем переход
	$k \Rightarrow k + 1$.

	Пусть $e \in A - B$~--- произвольный элемент и~выполнено $|B_{e}| < |B|$,
	тогда по индукции $|A + B| \ge |A_{(e)} + B_{(e)}| \ge \min\{|A_{(e)} +
	B_{(e)} - 1, p\} = \min\{|A| + |B| - 1, p\}$. Осталось показать, что найдётся
	такое $e$, что $B_{(e)} \ne B$.

	Пусть $B_{(e)} = B \Leftrightarrow B \subset A - e \Leftrightarrow B + e
	\subset A$ для всех $e$. Таким образом $A + B - B \subset A$. Так как $0 \in B
	- B$, то $A + B - B = A$ и~по структурной теореме $B - B \subset H$, где
	$H$~--- группа симметрии множества~$A$. Тогда либо $B - B = 0$, то есть $|B| =
	1$, либо $A = \mathbb{Z}_p$, то есть так или иначе шаг доказан.
\end{proof}

Все наши утверждения допускают следующее обобщение.

\begin{theorem}[Кнезер]
	Пусть $G$~--- абелева группа, $A, B$~--- её конечные непустые подмножества, $H
	= Sym(A + B)$. Тогда $|A + B| \ge |A + H| + |B + H| - |H|$.
\end{theorem}

\end{document}
