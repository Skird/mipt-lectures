\documentclass{article}
\input{common}

\begin{document}

\section{Проблема Эрдёша-Хайнала}

Задача: найти $m(k, r) = \min\{ |E(H)|: H~\text{--- }k-\text{однородный }, \chi(H) > r\}$.

\begin{exercise}
	$m(2, r) = C_{r+1}^2$.
\end{exercise}

Простая верхняя оценка: $m(k, r) \le C_{r(k-1)+1}^k$. Тогда для так называемой
property B problem $m(k, 2) \le C_{2k-1}^k \sim \frac{4^k}{2\sqrt{\pi k}}$.

Малые значения: $m(3, 2) = 7$~--- проективный треугольник Фано, который не
красится в~два цвета. Более сложные известные $m(4,2) = 23, m(5,2) = 51$.
Обычно это явная верхняя оценка плюс computer assisted разбор случаев для
нижней.

\begin{lemma}[Вероятностная нижняя оценка]
	$m(k, r) > r^{k-1}$.
\end{lemma}
\begin{proof}
	Пусть $H = (V, E)$~--- $k$-однородный, $|E| \le r^{k-1}$. Если $|E| \le 1$,
	всё очевидно. Иначе, возьмём случайную раскраску. $\forall A \in E \rightarrow
	P(A\text{~--- одноцветно}) = \frac{r}{r^k} = r^{1-k}$. $P(\exists
	\text{одноцветное ребро}) \le |E|r^{1-k} - r^{1-|V|} \le 1 - r^{1-|V|} < 1$.
\end{proof}

Применим к~многоцветным числам Рамсея:
$$R(s, r) = \{n: \text{в~любой раскраске рёбер $K_n$ в~$n$ цветов найдётся $K_s$
одного цвета}\}$$

Вершинами гиперграфа назначим рёбра исходного графа, а~рёбра проведём через те,
что образуют $K_s$. Получили $C_s^2$-однородный гиперграф. Очевидно, что
$R(s, n) > n \Leftrightarrow \chi(H_{n,r}) > r$. Отсюда получается оценка
$R(s, r) > \frac{s}{e} r^{\frac{s-1}{2} - \frac{1}{s}}$.

\begin{lemma}[Вероятностная верхняя оценка]
	$m(k, r) \le \frac{e}{2} k^2 (r-1) r^{k-1} \ln r (1 + o\left(\frac{1}{k}
	\right))$.
\end{lemma}
\begin{proof}
	Рассмотрим множество вершин $V, |V| = v$. Пусть $S \in_R C_V^k$. Тогда для
	фиксированной раскраски $\sigma$ оценим вероятность, что множество $S$
	одноцветно. Если в~$\sigma$ цветовые классы имеют размеры $v_1, \ldots, v_r$,
	то $P(S\text{~--- одноцеветно}) = \frac{C_{v_1}^k + \ldots + C_{v_r}^k}{C_v^k}
	\le \frac{r C_{\frac{v}{r}}^k}{C_v^k} = p$. Тогда вероятность, что $m$
	независимых случайных подмножеств одноцветны равна $\prod\limits_{i=1}^m
	(1-p)^m$.

	Тогда образуем случайный $k$-однородный гиперграф с~$m$ независимыми рёбрами.
	$P(\chi(H) \le r) = r^v (1-p)^m < e^{v \ln r - pm}$. Хотим, чтобы это было
	меньше 1. Это верно при $m = \left\lceil \frac{v \ln r}{p} + 1\right\rceil$.
	Теперь оптимизируем по $v$.

	\begin{multline*}
		p = \frac{r C_{\frac{v}{r}}^k}{C_v^k} = r \prod\limits_{i=0}^{k-1}
		\frac{\frac{v}{r} - i}{v - i} = r^{1-k} \prod\limits_{i=1}^{k-1} \frac{1 -
		\frac{ri}{v}}{1 - \frac{i}{v}} \ge r^{k-1} \exp\left(\sum\limits_{i=1}^{k-1}
		\frac{i}{v} - \frac{\frac{ri}{v}}{1 - \frac{ri}{v}}\right) =\\ r^{1-k}
		\exp\left( \sum\limits_{i=1}^{k-1} -\frac{(r-1)iv + ri^2}{v(v - ri)}\right)
		\ge r^{1-k} \exp\left( -\sum\limits_{i=1}^{k-1} \frac{(r-1)iv +
		ri^2}{v(v-rk)}\right) = \\ r^{1-k} \exp\left( -\frac{(r-1)k(k-1)}{2(v-rk)} -
		\frac{k(k-1)(2k-1)r}{6v(v-rk)}\right)
	\end{multline*}

	Берём $v = \frac{(r-1)k^2}{2}$, тогда $m \le \left\lceil \frac{v \ln r}{p} + 1
	\right\rceil = r^{k-1} \ln r \frac{(r-1)k^2}{2} e(1 +
	o\left(\frac{1}{k}\right))$.
\end{proof}

Если $r \gg k$, то полученная оценка хуже тривиальной, что неожиданно.

\begin{theorem}[Теорема Алона]
	Пусть $r > k$, тогда $m(k, r) > (k-1) \left\lceil \frac{r}{k} \right\rceil
	\left\lfloor \frac{k-1}{k} r\right\rfloor^{k-1}$.
\end{theorem}
\begin{proof}
	Пусть $a = \left\lceil \frac{k-1}{k}r\right\rceil, b \left\lfloor \frac{r}{k}
	\right\rfloor \Rightarrow a + b = r$. Пусть $H = (V, E)$~--- гиперграф
	с~условием, что $|E| \le (k-1)b a^{k-1}$. Выделим случайную раскраску $V$
	в~$\{1, \ldots, a\}$. Пусть $X$~--- число одноцветных рёбер в~этой раскраске,
	тогда $EX = |E| a^{1-k} \le (k - 1)b$. Тогда существует раскраска, в~которой
	$X \le (k - 1)b$. Пусть $A_1, \ldots, A_m$~--- одноцветные рёбра, $m \le (k -
	1)b$. Исправим в~них по одной вершине на~один из~$b$ цветов так, чтобы никакой
	цвет не использовался больше, чем $(k - 1)b$ раз.
\end{proof}

Итак, $m(k, r) > (k-1) \left\lceil \frac{r}{k} \right\rceil \left\lfloor
\frac{k - 1}{k}r\right\rfloor^{k-1} = \Omega(r^k)$ при $r \gg k$.

\section{Случай двух цветов}

\begin{itemize}
	\item Мы уже показали, что $2^{k-1} \le m(k, 2) = o(k^2 2^k)$
	\item Бек (1978): $m(k, 2) = \Omega\left( \left( \frac{k}{\ln
		k}\right)^\frac{1}{3} 2^k \right)$.
	\item Радхакришнан, Сринивасан (2000) $m(k, 2) = \Omega\left( \left(
		\frac{k}{\ln k}\right)^\frac{1}{2} 2^k \right)$.
\end{itemize}

\begin{definition}
	Пусть $H = (V, E)$, $r \ge 2, |V| = n, \sigma: V \rightarrow \{1, \ldots,
	n\}$~--- некоторая нумерация. Набор рёбер $(A_1, \ldots, A_r)$ образует
	упорядоченную $r$-цепь относительно $\sigma$, если
	\begin{itemize}
		\item $\forall i < j \rightarrow \sigma(A_i) \le \sigma(A_j)$
		\item $|A_i \cap A_{i+1}| = 1, \forall i = 1, \ldots, r - 1, |A_i \cap A_j|
			= \varnothing$ при $|i - j| > 1$.
	\end{itemize}
\end{definition}

Рассмотрим жадный алгоритм:
\begin{itemize}
	\item Раскрашиваем все в~цвет 1.
	\item Рассматриваем все вершины по порядку $\sigma$.
	\item Если текущая вершина является первой по номеру внутри какого-то ребра,
		то перекрасим её в~минимальный цвет, присвоение которого не даёт
		одноцветного ребра в~текущей раскраске. Если такого нет, то выбираем цвет
		$r$.
\end{itemize}

\begin{theorem}[Критерий $r$-раскрашиваемости гиперграфа, критерий Плухара]
	$\chi(H) \le r \Leftrightarrow \exists \sigma$ без упорядоченных $r$-цепей.
	В~последнем случае жадный алгоритм даёт правильную раскраску.
\end{theorem}
\begin{proof}
	Докажем необходимость. Пусть $f$~--- правильная раскраска в~$r$ цветов.
	Построим нумерацию так: сначала все вершины первого цвета, потом второго, to
	be continued. Пусть $(A_1, \ldots, A_r)$~--- упорядоченная $r$-цепь
	относительно $\sigma$. Тогда цвета <<точек сочленения>> равны $1, \ldots, r$,
	значит последнее множество $A_r$ одноцветно, противоречие.

	Теперь достаточность. Пусть есть нумерация без упорядоченных $r$-цепей. Пусть
	жадный алгоритм не находит правильной раскраски. Пусть ребро $A_{r-1}$
	получилось одноцветным. Тогда согласно алгоритму ребро $A_{r-1}$ полностью
	имеет цвет $r$. Обозначим первую его вершину $v_{r-1}$. Тогда в~момент
	покраски этой вершины было ребро $A_{r-2}$ цвета $r-1$, притом все его вершины
	уже были перекрашены. Таким образом, мы продолжаем цепь в~порядке уменьшения
	нумерации. Так, мы дойдём до ребра $A_1$ цвета 2.

	Рассмотрим последнюю вершину $A_{r-1}$. Она была перекрашена в~цвет $r$,
	значит она была первой в~каком-то ребре $A_r$. Это ребро может быть цвета 1.
	Получили упорядоченную $r$-цепь $A_1, \ldots, A_r$.
\end{proof}

\begin{exercise}
	Идея случайной нумерации в~простом виде даёт оценку $\Omega(k^\frac{1}{4}
	2^k)$.
\end{exercise}

\end{document}
